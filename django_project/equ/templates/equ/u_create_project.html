{% extends "equ/u_base.html" %}
{% block content %}

<form method="post" action="{% url 'u_create_project' %}" class="project-form">
  {% csrf_token %}

  <!-- Project Details -->
  <label for="id_name">Name:</label>
  {{ project_form.name }}
  <br>
  <label for="id_description">Description:</label>
  {{ project_form.description }}
  <br>
  <label for="id_start_date">Start Date:</label>
  {{ project_form.start_date }}
  <br>
  <label for="id_end_date">End Date:</label>
  {{ project_form.end_date }}
  <br>

  {% if error_message %}
  <div class="error-message">>{{ error_message }}</div>
  <br>
  <a href="{% url 'c_list' %}" class="btn-uproject">View Calendar</a>
  <br>
  {% endif %}

  <!-- Bookings Container - Initially Hidden -->
  <div id="bookings-container" >
    <div class="booking-form">
      <h3>Booking 1</h3>
      {{ booking_formset.management_form }}
      {% for form in booking_formset %}
      <div id="booking-{{ forloop.counter }}">
        <!-- Equipment Dropdown for Booking Slot -->
        <label for="{{ form.equipment.id_for_label }}">Equipment:</label>
      {{ form.equipment }}
      {% if form.equipment.errors %}
        <div class="error-message">{{ form.equipment.errors }}</div>
      {% endif %}
      <br>
      <!-- Start Time for Booking Slot -->
      <label for="{{ form.start_time.id_for_label }}">Start Time:</label>
      {{ form.start_time }}
      {% if form.start_time.errors %}
        <div class="error-message">{{ form.start_time.errors }}</div>
      {% endif %}
      <br>
      <!-- End Time for Booking Slot -->
      <label for="{{ form.end_time.id_for_label }}">End Time:</label>
      {{ form.end_time }}
      {% if form.end_time.errors %}
        <div class="error-message">{{ form.end_time.errors }}</div>
      {% endif %}
      <br>

      <div class="materials-container">

      <label for="{{ form.materials.id_for_label }}">Materials:</label>
      {{ form.materials }}
      {% if form.materials.errors %}
        <div class="error-message">{{ form.materials.errors }}</div>
      {% endif %}
      <br>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>



  <button type="button" id="add-booking-btn">Add Slot</button>


  <button type="submit" class="submit-btn">Submit</button>
</form>

<!-- JavaScript to Handle Show/Hide of Bookings Container and Enable/Disable Add Slot Button -->

<script>
  const addBookingBtn = document.getElementById('add-booking-btn');
  const bookingsContainer = document.getElementById('bookings-container');
  const equipmentDropdown = document.getElementById("id_booking_set-0-equipment");
  const createslotbtn = document.getElementById('create-slot-btn');

  

 // Enable/Disable Add Slot Button Based on Equipment Dropdown Selection
  equipmentDropdown.addEventListener("change", () => {
    if (equipmentDropdown.value) {
      addBookingBtn.disabled = false; // Enable Add Slot Button
    } else {
      addBookingBtn.disabled = true; // Disable Add Slot Button
      bookingsContainer.style.display = "none"; // Hide Bookings Container
    }
  }); 

  const equipmentDropdowns = document.querySelectorAll('select[name^="equipment_"]');
 
</script>

 
{% endblock content %}
